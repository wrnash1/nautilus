--------------
CREATE TABLE IF NOT EXISTS `rma_items` (
  `id` INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  `rma_request_id` INT UNSIGNED NOT NULL,
  `transaction_item_id` BIGINT UNSIGNED COMMENT 'Original transaction item',
  `product_id` INT UNSIGNED NOT NULL,
  `variant_id` INT UNSIGNED,
  `quantity` INT NOT NULL DEFAULT 1,
  `unit_price` DECIMAL(10,2) NOT NULL,
  `total_price` DECIMAL(10,2) NOT NULL,
  `condition_received` ENUM('unopened', 'opened_unused', 'used_good', 'used_fair', 'damaged', 'defective') COMMENT 'Condition when received',
  `disposition` ENUM('restock', 'vendor_return', 'scrap', 'repair', 'pending') DEFAULT 'pending',
  `restocked` BOOLEAN DEFAULT FALSE,
  `restocked_date` TIMESTAMP NULL,
  `notes` TEXT,
  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

  FOREIGN KEY (`rma_request_id`) REFERENCES `rma_requests`(`id`) ON DELETE CASCADE,
  FOREIGN KEY (`transaction_item_id`) REFERENCES `transaction_items`(`id`) ON DELETE SET NULL,
  FOREIGN KEY (`product_id`) REFERENCES `products`(`id`),
  FOREIGN KEY (`variant_id`) REFERENCES `product_variants`(`id`),

  INDEX `idx_rma_request` (`rma_request_id`),
  INDEX `idx_product` (`product_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='Individual items in an RMA request'
--------------

ERROR 1005 (HY000) at line 68: Can't create table `nautilus`.`rma_items` (errno: 150 "Foreign key constraint is incorrectly formed")
